---
title: "first_lake_report"
output: html_document
date: "2025-03-18"
---

```{r setup, include=FALSE}
if (!require(dplyr)) {install.packages("dplyr")}
if (!require(tidyverse)) {install.packages("tidyverse")}

library(readr)
library(stringr)
```

## Downloading Folder with All Data\
```{r}
folder = "C:/Users/mvhfg/OneDrive - University of Missouri/North_Limnology/priv_lake_rep/Private_Lake_Reports/2024 Data"
files = list.files(
  path = folder,
  pattern = ".*csv$",
  ignore.case = F,
  full.names = T #provides path to folder
)

files2 <- list.files("2024 Data", pattern="*.csv")

library(readr)
library(stringr)

for(i in 1:length(files)) {
  file_name <- str_sub(string = files[i], start = 111)
  file_df <- read.csv(paste0(folder,"/",files2[i]),header = TRUE, sep=",")
  #file_df <- file_df[c(3:2714),2:3] #i only need the col 2&3 and keep rows 2:2714
  #cols <- names(file_df)[14] #getting the 14th column 
  #file_df[cols] <- lapply(file_df[cols], as.numeric) #making the cols column(s) numeric
  assign( x = file_name, value = file_df, envir = .GlobalEnv)
}
```


## Results

### Total Nitrogen & Total Phosphorus\
Total Nitrogen is not available yet
```{r}
#all TP data
#we want to extract TP values for lake 14 - Tishomingo
# we are only looking at surface samples so the Depth has to be SURF
tp_14 <- SLAP_2024_TP.csv%>%
  filter(MULakeNumber == "014" & Depth == "SURF")
#for depth instead of looking for SURF, look for endDepth = 0
```

Averaging TP Data
```{r}
tp_14_avg <- tp_14 %>%
  group_by(Date)%>%
  summarise(Average_TP = mean(parameterValue)) #units in ug/L
```

Toxins
```{r}
ANAtox <- SLAP_2024_ANA_tox.csv[,1:19] #keeps the first 19 columns
CLYtox <- SLAP_2024_CLY_tox.csv[,1:19]
MICtox <- SLAP_2024_MIC_tox.csv[,1:19]
SAXtox <- SLAP_2024_SAX_tox.csv[,1:19]

ANAtox_14 <- ANAtox%>%
  filter(MULakeNumber == "014")

CLYtox_14 <- CLYtox%>%
  filter(MULakeNumber == "014")

MICtox_14 <- MICtox%>%
  filter(MULakeNumber == "014")

SAXtox_14 <- SAXtox%>%
  filter(MULakeNumber == "014")

ALLtox_14 <- bind_rows(ANAtox_14, CLYtox_14, MICtox_14, SAXtox_14)
```

Full df of Toxins
```{r}
tox_avg_14 <- ALLtox_14 %>%
  group_by(Date, parameterType)%>%
  summarise(avg_tox = mean(parameterValue)) #units in ug/L

if (!require(ggplot2)) {install.packages("ggplot2")}


ggplot(tox_avg_14, aes(x=Date, y=avg_tox, group=parameterType)) +
  geom_line(size =0.75, aes(color =parameterType)) +
  geom_point(aes(shape=parameterType, color=parameterType, size=parameterType))+
  scale_shape_manual(values=c(15, 16, 17, 18))+
  scale_color_manual(values=c('brown4','orange', 'palegreen3', 'steelblue'))+
  scale_size_manual(values=c(8,8,5,6))+
  theme(legend.position="right")+
  theme_bw()+
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank())+
  xlab('Date')+
  ylab('Average Cyanotoxin Concentration (ug/L)') 
#best one so far



```

